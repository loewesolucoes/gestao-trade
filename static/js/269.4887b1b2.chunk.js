(()=>{"use strict";let e=function(e){return e.LOAD_ALL="loadAll",e.CONNECT="connect",e}({});class s{static _init(){s.broadcastSend.onmessage=e=>{s.onMessages.forEach((s=>s(e)))},s.broadcastSend.onmessageerror=e=>{console.error("DBWorkerUtil.onmessageerror",e)},s.broadcastReceive.onmessage=e=>{const{id:s}=e.data,a=this.onExecMessages[s];if(null==a)throw console.error("invalid message id",s,e),new Error("invalid message id => ".concat(s));a(e),delete this.onExecMessages[s]},s.broadcastReceive.onmessageerror=e=>{console.error("DBWorkerUtil.onmessageerror",e)}}constructor(e){this.workerName=e,this.currentId=0}static setOnMessage(e){this.onMessages.push(e)}static postReceive(e){s.broadcastReceive.postMessage(e.data)}async exec(e,a){const o="sw-".concat(this.workerName,"-").concat(this.currentId++);return new Promise(((t,r)=>{s.onExecMessages[o]=e=>{console.debug("DBWorkerUtil.onmessage",e.data.id,o,e),e.data.id===o&&(e.data.error?r(e.data):t(e.data.results))},console.debug("DBWorkerUtil.sending","exec",o,e,a),s.broadcastSend.postMessage({id:o,action:"exec",sql:e,params:a})}))}}s.broadcastSend=new BroadcastChannel("gestao-database-channel-send"),s.broadcastReceive=new BroadcastChannel("gestao-database-channel-receive"),s.onMessages=[],s.onExecMessages={},s._init(),console.debug("brapi-worker start");const a=new s("brapi");self.onmessage=s=>{if(console.debug("brapi.onmessage",s),s.data.action===e.LOAD_ALL)!async function(e){const s=await fetch("https://brapi.dev/api/quote/list"),{stocks:o}=await s.json(),t=o.map((e=>({nome:e.name,codigo:e.stock,tipo:null!=e.sector?1:4,active:!0,valorDeMercado:e.market_cap,logo:e.logo,setor:e.sector}))),r=await a.exec("select * from acoes");console.log(r),self.postMessage({id:e.id,response:t})}(s.data)},console.debug("brapi-worker end")})();
//# sourceMappingURL=269.4887b1b2.chunk.js.map