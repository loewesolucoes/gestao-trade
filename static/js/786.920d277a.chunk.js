"use strict";(self.webpackChunkgestao_trade=self.webpackChunkgestao_trade||[]).push([[786],{157:(e,o,i)=>{i.d(o,{p:()=>l});var t=i(45),a=i(178),n=i.n(a),s=i(579);function l(e){const{onChange:o,isNumber:i,groupSymbolLeft:a,groupSymbolRight:l,isPercent:r,value:d,...u}=e,c="number"===e.type||i,m="date"===e.type,v="month"===e.type,h="textarea"===e.type;function f(e){const{value:i}=e.target,a=o||function(){};a(r?(0,t.A)(i).div(100):c?(0,t.A)(i):m?n()(i,"YYYY-MM-DD").toDate():v?n()(i,"YYYY-MM").toDate():i)}const b=function(e,o,i,t,a){return o?function(e,o){let{isPercent:i}=o;return null==e||isNaN(e.toNumber())?"":i?e.times(100).toNumber():e.toNumber()}(e,{isPercent:a}):i?n()(e).format("YYYY-MM-DD"):t?n()(e).format("YYYY-MM"):e||""}(d,c,m,v,r),p=h?(0,s.jsx)("textarea",{className:"form-control",onChange:f,value:b,...u}):(0,s.jsx)("input",{className:"form-control",onChange:f,value:b,...u});return a||l?(0,s.jsxs)("div",{className:"input-group mb-3",children:[a&&(0,s.jsx)("span",{className:"input-group-text",children:a}),p,l&&(0,s.jsx)("span",{className:"input-group-text",children:l})]}):p}},964:(e,o,i)=>{i.d(o,{l:()=>s});var t=i(642);class a{static keyFromValue(e,o){return Object.keys(e)[Object.values(e).indexOf(o)]}static values(e){return Object.keys(e).filter((e=>isNaN(e)))}}var n=i(579);function s(e){const{acao:o,isActive:i,onClick:s}=e;return(0,n.jsxs)("button",{type:"button",className:"stock-card ".concat(i?"marked":""," ").concat(o.active?"active":"").trim(),onClick:()=>s(o),children:[(0,n.jsx)("img",{src:o.logo,alt:o.nome}),(0,n.jsx)("h4",{children:o.nome}),(0,n.jsx)("small",{children:o.codigo}),(0,n.jsxs)("div",{className:"info",children:[o.setor&&(0,n.jsx)("span",{children:o.setor}),o.tipo&&(0,n.jsx)("span",{children:a.keyFromValue(t.t,o.tipo)})]})]})}},786:(e,o,i)=>{i.r(o),i.d(o,{default:()=>Y});var t=i(415),a=i(43),n=i(401),s=i(964),l=i(547),r=i(178),d=i.n(r),u=i(579);let c;const m=e=>{const{data:o,analysis:i,visibleFrom:t,visibleTo:n,...s}=e,r=(0,a.useRef)();function m(){null==t||null==n?c.timeScale().fitContent():c.timeScale().setVisibleRange({from:d()(t).unix(),to:d()(n).unix()})}return(0,a.useEffect)((()=>{const e=()=>{c.applyOptions({width:r.current.clientWidth})};c=(0,l.R9)(r.current,{width:r.current.clientWidth,height:500,layout:{textColor:"rgba(0, 0, 0, 0.9)"},grid:{vertLines:{color:"rgba(197, 203, 206, 0.5)"},horzLines:{color:"rgba(197, 203, 206, 0.5)"}},crosshair:{mode:l._q.Normal},rightPriceScale:{borderColor:"rgba(197, 203, 206, 0.8)"},timeScale:{borderColor:"rgba(197, 203, 206, 0.8)"}});c.addCandlestickSeries({}).setData(o),m();for(let o=0;o<i.length;o++){const e=i[o],t=v();c.addLineSeries({color:t,lineStyle:0,lastValueVisible:!1,priceLineVisible:!1}).setData([{time:d()(e.dataInicio).format("YYYY-MM-DD"),value:e.fibo0},{time:d()(e.dataFim).format("YYYY-MM-DD"),value:e.fibo0}]);c.addLineSeries({color:t,lineStyle:2,lastValueVisible:!1,priceLineVisible:!1}).setData([{time:d()(e.dataInicio).format("YYYY-MM-DD"),value:e.fibo382},{time:d()(e.dataFim).format("YYYY-MM-DD"),value:e.fibo382}]);c.addLineSeries({color:t,lineStyle:2,lastValueVisible:!1,priceLineVisible:!1}).setData([{time:d()(e.dataInicio).format("YYYY-MM-DD"),value:e.fibo618},{time:d()(e.dataFim).format("YYYY-MM-DD"),value:e.fibo618}]);c.addLineSeries({color:t,lineStyle:1,lastValueVisible:!1,priceLineVisible:!1}).setData([{time:d()(e.dataInicio).format("YYYY-MM-DD"),value:e.fibo50},{time:d()(e.dataFim).format("YYYY-MM-DD"),value:e.fibo50}]);c.addLineSeries({color:t,lineStyle:0,lastValueVisible:!1,priceLineVisible:!1}).setData([{time:d()(e.dataInicio).format("YYYY-MM-DD"),value:e.fibo1000},{time:d()(e.dataFim).format("YYYY-MM-DD"),value:e.fibo1000}])}return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e),c.remove()}}),[o]),(0,a.useEffect)((()=>{m()}),[t,n]),(0,u.jsx)("div",{ref:r,...s})};function v(){for(var e="#",o=0;o<6;o++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}let h=function(e){return e.SUBIDA="SUBIDA",e.DESCIDA="DESCIDA",e.UNCOMPLETED="UNCOMPLETED",e}({}),f=function(e){return e.TOPO="TOPO",e.FUNDO="FUNDO",e}({}),b=function(e){return e.ALTA="ALTA",e.BAIXA="BAIXA",e}({});const p=new class{run(e,o,i){if(0===e.length)return[];const t=e.filter((e=>d()(e.date).isBetween(o,i))),a=this.toposEFundos(t,2),n=this.parseToMovementsTresPontos(a,b.ALTA),s=this.parseToMovementsTresPontos(a,b.BAIXA),l=this.criarFiboEAlvos(n),r=this.criarFiboEAlvos(s);return l.concat(r)}criarFiboEAlvos(e){var o;const i=(null===(o=e[e.length-1])||void 0===o?void 0:o.movements)||[],t=i[i.length-1];return e.map((e=>{const o={...e},i=o.movements[0],a=o.movements[o.movements.length-1],n=a.high.minus(i.low);return o.dataInicio=i.date,o.dataFim=a.date,o.type===h.DESCIDA?(o.fibo0=i.high,o.fibo382=i.high.minus(n.times(.382)),o.fibo618=i.high.minus(n.times(.618)),o.fibo50=i.high.minus(n.times(.5)),o.fibo1000=a.low,o.alvo1=o.fibo618.minus(o.fibo0).div(.618).plus(o.fibo618),o.bateuAlvo1=t.low.isLessThanOrEqualTo(o.alvo1),o.alvo2=o.fibo50.minus(o.fibo0).div(.5).plus(o.fibo1000),o.bateuAlvo2=t.low.isLessThanOrEqualTo(o.alvo2),o.alvo3=o.fibo382.minus(o.fibo0).div(.382).plus(o.alvo1),o.bateuAlvo3=t.low.isLessThanOrEqualTo(o.alvo3)):(o.fibo0=i.low,o.fibo382=i.low.plus(n.times(.382)),o.fibo618=i.low.plus(n.times(.618)),o.fibo50=i.low.plus(n.times(.5)),o.fibo1000=a.high,o.alvo1=o.fibo618.minus(o.fibo0).div(.618).plus(o.fibo618),o.bateuAlvo1=t.high.isGreaterThanOrEqualTo(o.alvo1),o.alvo2=o.fibo50.minus(o.fibo0).div(.5).plus(o.fibo1000),o.bateuAlvo2=t.high.isGreaterThanOrEqualTo(o.alvo2),o.alvo3=o.fibo382.minus(o.fibo0).div(.382).plus(o.alvo1),o.bateuAlvo3=t.high.isGreaterThanOrEqualTo(o.alvo3)),o}))}parseToMovementsTresPontos(e,o){return e.reduce(((e,i)=>{const t=e[e.length-1];if(null==t)s();else if(1===t.movements.length)t.movements.push(i.data),1===e.length&&(o===b.ALTA&&i.type==f.FUNDO&&s(),o===b.BAIXA&&i.type==f.TOPO&&s());else{var a,n;const e=t.movements[0];t.movements.push(i.data),o===b.BAIXA?t.movementType=null!==(a=e.high)&&void 0!==a&&a.isLessThanOrEqualTo(i.data.high)?h.SUBIDA:h.DESCIDA:t.movementType=null!==(n=e.low)&&void 0!==n&&n.isLessThanOrEqualTo(i.data.low)?h.SUBIDA:h.DESCIDA,s()}return e;function s(){e.push({index:i.index,order:i.order,movements:[i.data],movementType:h.UNCOMPLETED})}}),[])}parseToMovementsDoisPontos(e){return e.reduce(((e,o)=>{const i=e[e.length-1];if(null==i)e.push({index:o.index,order:o.order,movements:[o.data],movementType:h.UNCOMPLETED});else{const t=i.movements[i.movements.length-1];t.min<=o.data.min?e.push({index:i.index,order:i.order,movements:[t,o.data],movementType:h.SUBIDA}):e.push({index:i.index,order:i.order,movements:[t,o.data],movementType:h.DESCIDA})}return e}),[])}toposEFundos(e,o){const i=this.extremos(e,o);return i.topos.concat(i.fundos).sort(((e,o)=>e.index<o.index?-1:e.index>o.index?1:0)).reduce(((e,o)=>{const i=e[e.length-1];return(null===i||void 0===i?void 0:i.type)!=o.type&&e.push(o),e}),[])}extremos(e,o){const i=[],t=[];for(let a=0;a<e.length;a++)this.ehTopo(e,a,o)&&i.push({index:a,order:a-o,date:e[a].date,data:{...e[a],type:f.TOPO},type:f.TOPO}),this.ehFundo(e,a,o)&&t.push({index:a,order:a-o,date:e[a].date,data:{...e[a],type:f.FUNDO},type:f.FUNDO});return{topos:i,fundos:t}}ehTopo(e,o,i){var t=!0,a=e[o].high;for(let s=1;s<i+1;s++){var n;const i=null===(n=e[o+s])||void 0===n?void 0:n.high,l=null===a||void 0===a?void 0:a.isLessThanOrEqualTo(i);if(null==i||l){t=!1;break}}return t}ehFundo(e,o,i){var t=!0,a=e[o].low;for(let s=1;s<i+1;s++){var n;const i=null===(n=e[o+s])||void 0===n?void 0:n.low,l=null===a||void 0===a?void 0:a.isGreaterThanOrEqualTo(i);if(null==i||l){t=!1;break}}return t}};var D=i(157),g=i(32);function Y(){const{isMobile:e}=(0,g.D)(),{isDbOk:o,repository:i}=(0,n.r)(),l=e?-1:-3,[r,c]=(0,a.useState)(d()().add(l,"months").format("YYYY-MM-DD")),[v,h]=(0,a.useState)(d()().format("YYYY-MM-DD")),[f,b]=(0,a.useState)(),[Y,N]=(0,a.useState)(),[T,y]=(0,a.useState)(),[A,M]=(0,a.useState)();return(0,a.useEffect)((()=>{document.title="In\xedcio | ".concat("Gest\xe3o de trading")}),[]),(0,a.useEffect)((()=>{o&&async function(){const e=await i.acoes.listActives();b(e)}()}),[o]),(0,a.useEffect)((()=>{o&&async function(){if(y(void 0),null==Y)return;const e=await i.historicoAcoes.listByCode(Y);y(e.map((e=>{var o,i,t,a;return{time:d()(e.date).format("YYYY-MM-DD"),open:null===(o=e.open)||void 0===o?void 0:o.toNumber(),close:null===(i=e.close)||void 0===i?void 0:i.toNumber(),high:null===(t=e.high)||void 0===t?void 0:t.toNumber(),low:null===(a=e.low)||void 0===a?void 0:a.toNumber()}})));const o=p.run(e,r,v);M(o.filter((e=>"UNCOMPLETED"!==e.movementType)).map((e=>{var o,i,t,a,n,s,l,r;return{...e,alvo1:null===(o=e.alvo1)||void 0===o?void 0:o.toNumber(),alvo2:null===(i=e.alvo2)||void 0===i?void 0:i.toNumber(),alvo3:null===(t=e.alvo3)||void 0===t?void 0:t.toNumber(),fibo0:null===(a=e.fibo0)||void 0===a?void 0:a.toNumber(),fibo382:null===(n=e.fibo382)||void 0===n?void 0:n.toNumber(),fibo618:null===(s=e.fibo618)||void 0===s?void 0:s.toNumber(),fibo50:null===(l=e.fibo50)||void 0===l?void 0:l.toNumber(),fibo1000:null===(r=e.fibo1000)||void 0===r?void 0:r.toNumber()}})))}()}),[o,Y]),(0,u.jsx)(t.P,{children:(0,u.jsxs)("section",{className:"container",children:[(0,u.jsxs)("div",{className:"configs",children:[(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"dataInicio",className:"form-label",children:"Data inicio:"}),(0,u.jsx)(D.p,{type:"date",id:"dataInicio",name:"dataInicio",className:"form-control",value:r,onChange:e=>c(e)})]}),(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{htmlFor:"dataFim",className:"form-label",children:"Data fim:"}),(0,u.jsx)(D.p,{type:"date",id:"dataFim",name:"dataFim",className:"form-control",value:v,onChange:e=>h(e)})]})]}),null==f?(0,u.jsx)("div",{className:"alert alert-info",children:"Carregando a\xe7\xf5es ativas..."}):0===f.length?(0,u.jsx)("div",{className:"alert alert-info",children:"Nenhuma a\xe7\xe3o ativa..."}):(0,u.jsx)("div",{className:"stocks",children:f.map((e=>(0,u.jsx)(s.l,{acao:e,isActive:e.codigo===Y,onClick:e=>N(e.codigo)},e.codigo)))}),null==Y?(0,u.jsx)("div",{className:"alert alert-warning",children:"Escolha uma a\xe7\xe3o para analisar"}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("section",{className:"card analysis",children:[(0,u.jsx)("div",{className:"card-header",children:"Analise"}),(0,u.jsx)("div",{className:"card-body",children:null==A?(0,u.jsx)("div",{className:"alert alert-info",children:"Carregando analises..."}):(0,u.jsx)("div",{style:{whiteSpace:"pre",maxHeight:300,overflow:"auto"},children:x(A)})})]}),null==T?(0,u.jsx)("div",{className:"alert alert-info",children:"Carregando hist\xf3rico..."}):(0,u.jsx)(m,{className:"chart",data:T,visibleFrom:r,visibleTo:v,analysis:A})]})]})})}function x(e){return JSON.stringify(e.map((e=>(e.movements=void 0,e))),null,4)}}}]);
//# sourceMappingURL=786.920d277a.chunk.js.map