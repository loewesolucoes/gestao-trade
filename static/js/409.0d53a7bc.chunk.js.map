{"version":3,"file":"static/js/409.0d53a7bc.chunk.js","mappings":"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","sources":["workers/common.ts","workers/db-connector.ts","repositories/database-connector.ts","utils/repository.ts","repositories/default.ts","repositories/parametros.ts","workers/yahoo.ts","repositories/historico-acoes.ts","../webpack/bootstrap","../webpack/runtime/chunk loaded","../webpack/runtime/compat get default export","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/global","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/node module decorator","../webpack/runtime/publicPath","../webpack/runtime/importScripts chunk loading","../webpack/runtime/startup chunk dependencies","../webpack/startup"],"sourcesContent":["export enum WorkersActions {\r\n  LOAD_ALL = \"loadAll\",\r\n  CONNECT = \"connect\",\r\n}\r\n\r\nexport interface GestaoMessage {\r\n  id: number;\r\n  action: WorkersActions;\r\n  params: any;\r\n}\r\n\r\nexport const UNIQUE_KEY = crypto.randomUUID();\r\nexport const DB_BROADCAST_CHANNEL_SW_KEY = 'DB_BROADCAST_CHANNEL_SW'","import { IDatabase } from \"../repositories/database-connector\";\r\nimport { DB_BROADCAST_CHANNEL_SW_KEY, UNIQUE_KEY } from \"./common\";\r\n\r\nconst DB_CHANNEL_SEND = `gestao-database-channel-send-${UNIQUE_KEY}`;\r\nconst DB_CHANNEL_RECEIVE = `gestao-database-channel-receive-${UNIQUE_KEY}`;\r\n\r\nexport class WorkerDatabaseConnector implements IDatabase {\r\n  private readonly broadcastSend: BroadcastChannel = new BroadcastChannel(DB_CHANNEL_SEND);\r\n  private readonly broadcastReceive: BroadcastChannel = new BroadcastChannel(DB_CHANNEL_RECEIVE);\r\n  private readonly broadcastConnect: BroadcastChannel = new BroadcastChannel(DB_BROADCAST_CHANNEL_SW_KEY);\r\n  private readonly onMessages: ((event: MessageEvent) => void)[] = [];\r\n  private readonly onExecMessages: { [key: string]: (event: MessageEvent) => void } = {};\r\n  private readonly workerName: string\r\n  private currentId = 0;\r\n\r\n  constructor(workerName: string) {\r\n    this.workerName = `sw-${workerName}`;\r\n\r\n    this.broadcastReceive.onmessage = (event) => {\r\n      const { id } = event.data;\r\n      const action = this.onExecMessages[id];\r\n\r\n      if (action == null) {\r\n        // se estiver dando erro nessa parte deve ser devido a possuir duas tabs abertas\r\n        console.debug('invalid message id', id, event);\r\n\r\n        throw new Error('invalid message id');\r\n      }\r\n\r\n      action(event);\r\n      delete this.onExecMessages[id];\r\n    }\r\n\r\n    this.broadcastReceive.onmessageerror = (event) => {\r\n      console.error('WorkerDatabaseConnector.onmessageerror', event);\r\n    }\r\n\r\n    this.broadcastConnect.postMessage({\r\n      id: 'connect',\r\n      swName: this.workerName,\r\n      sendChannel: DB_CHANNEL_SEND,\r\n      receiveChannel: DB_CHANNEL_RECEIVE,\r\n    })\r\n  }\r\n\r\n  public setOnMessage(action: (e: MessageEvent) => void) {\r\n    this.onMessages.push(action);\r\n  }\r\n\r\n  public postReceive(event: MessageEvent) {\r\n    this.broadcastReceive.postMessage(event.data);\r\n  }\r\n\r\n  public async exec(sql: string, params?: any): Promise<initSqlJs.QueryExecResult[]> {\r\n    const nextId = `${this.workerName}:exec-${this.currentId++}`;\r\n\r\n    return new Promise((resolve, reject) => {\r\n      this.onExecMessages[nextId] = event => {\r\n        console.debug('WorkerDatabaseConnector.onmessage', event.data.id, nextId, event);\r\n\r\n        if (event.data.id === nextId) {\r\n          if (event.data.error)\r\n            reject(event.data);\r\n          else\r\n            resolve(event.data.results);\r\n        }\r\n      };\r\n\r\n      console.debug('WorkerDatabaseConnector.sending', 'exec', nextId, sql, params);\r\n\r\n      this.broadcastSend.postMessage({\r\n        id: nextId,\r\n        action: \"exec\",\r\n        sql: sql,\r\n        params: params\r\n      });\r\n    });\r\n  }\r\n\r\n  public async export(): Promise<Uint8Array> {\r\n    const nextId = `${this.workerName}:export-${this.currentId++}`;\r\n\r\n    return new Promise((resolve, reject) => {\r\n      this.onExecMessages[nextId] = event => {\r\n        console.debug('WorkerDatabaseConnector.onmessage', event.data.id, nextId, event);\r\n\r\n        if (event.data.id === nextId) {\r\n          if (event.data.error)\r\n            reject(event.data);\r\n          else\r\n            resolve(event.data.buffer);\r\n        }\r\n      };\r\n\r\n      console.debug('WorkerDatabaseConnector.sending', 'export', nextId);\r\n\r\n      this.broadcastSend.postMessage({\r\n        id: nextId,\r\n        action: \"export\",\r\n      });\r\n    });\r\n  }\r\n\r\n  public async open(data?: Buffer | ArrayLike<number> | null | undefined): Promise<any> {\r\n    throw new Error(\"Method not implemented.\");\r\n  }\r\n}","\r\nexport interface IDatabase {\r\n  exec(sql: string, params?: any): Promise<initSqlJs.QueryExecResult[]>\r\n  export(): Promise<Uint8Array>\r\n  open(data?: ArrayLike<number> | Buffer | null): Promise<any>\r\n}\r\n\r\n\r\nexport class DatabaseConnector implements IDatabase {\r\n  private currentId = 0;\r\n  private readonly worker: Worker;\r\n  private readonly onMessages: { [key: string]: (event: MessageEvent) => void } = {};\r\n\r\n  constructor() {\r\n    this.worker = new Worker(new URL(\"../workers/db-broadcast.ts\", import.meta.url));\r\n    this.worker.onerror = e => console.log(\"Worker error: \", e);\r\n    this.worker.onmessage = (event) => {\r\n      const { id } = event.data;\r\n      const action = this.onMessages[id];\r\n\r\n      if (action == null) {\r\n        console.error('invalid message id', id, event);\r\n\r\n        throw new Error(`invalid message id => ${id}`);\r\n      }\r\n\r\n      action(event);\r\n      delete this.onMessages[id];\r\n    }\r\n  }\r\n\r\n  public async exec(sql: string, params?: any): Promise<initSqlJs.QueryExecResult[]> {\r\n    const nextId = `exec-${this.currentId++}`;\r\n\r\n    return new Promise((resolve, reject) => {\r\n      this.onMessages[nextId] = event => {\r\n        console.debug('DatabaseConnector.onmessage', event.data.id, nextId, event);\r\n\r\n        if (event.data.id === nextId) {\r\n          if (event.data.error)\r\n            reject(event.data);\r\n          else\r\n            resolve(event.data.results);\r\n        }\r\n      };\r\n\r\n      console.debug('DatabaseConnector.sending', 'exec', nextId, sql, params);\r\n\r\n      this.worker.postMessage({\r\n        id: nextId,\r\n        action: \"exec\",\r\n        sql: sql,\r\n        params: params\r\n      });\r\n    });\r\n  }\r\n\r\n  public async export(): Promise<Uint8Array> {\r\n    const nextId = `export-${this.currentId++}`;\r\n\r\n    return new Promise((resolve, reject) => {\r\n      this.onMessages[nextId] = event => {\r\n        console.debug('DatabaseConnector.onmessage', event.data.id, nextId, event);\r\n        if (event.data.id === nextId) {\r\n          if (event.data.error)\r\n            reject(event.data);\r\n          else\r\n            resolve(event.data.buffer);\r\n        }\r\n      };\r\n\r\n      console.debug('DatabaseConnector.sending', 'export', nextId);\r\n\r\n      this.worker.postMessage({\r\n        id: nextId,\r\n        action: \"export\",\r\n      });\r\n    });\r\n  }\r\n\r\n  public async open(data?: ArrayLike<number> | Buffer | null): Promise<any> {\r\n    const nextId = `open-${this.currentId++}`;\r\n\r\n    return new Promise((resolve, reject) => {\r\n      this.onMessages[nextId] = event => {\r\n        console.debug('DatabaseConnector.onmessage', event.data.id, nextId, event);\r\n        if (event.data.id === nextId) {\r\n          if (event.data.error)\r\n            reject(event.data);\r\n          else\r\n            resolve(event.data);\r\n        }\r\n      };\r\n\r\n      console.debug('DatabaseConnector.sending', 'open', nextId);\r\n\r\n      this.worker.postMessage({\r\n        id: nextId,\r\n        action: \"open\",\r\n        buffer: data, /*Optional. An ArrayBuffer representing an SQLite Database file*/\r\n      });\r\n    });\r\n  }\r\n}","import localforage from 'localforage'\r\nimport { Buffer } from 'buffer';\r\nimport { DefaultRepository } from '../repositories/default';\r\nimport { DatabaseConnector } from '../repositories/database-connector';\r\n\r\nconst BUFFER_TYPE = 'base64';\r\n\r\nexport class RepositoryUtil {\r\n  public static readonly DB_NAME = 'gestao-trade.settings.db';\r\n\r\n  public static async create(data?: ArrayLike<number> | Buffer | null) {\r\n    const localDump = await RepositoryUtil.exportLocalDump();\r\n\r\n    if (data == null && localDump != null) {\r\n      data = Buffer.from(localDump, BUFFER_TYPE);\r\n    }\r\n\r\n    const db = new DatabaseConnector();\r\n\r\n    await db.open(data);\r\n\r\n    const repo = new DefaultRepository(db);\r\n\r\n    // @ts-ignore\r\n    await repo.runMigrations();\r\n\r\n    if (process.env.NODE_ENV !== 'production') {\r\n      //@ts-ignore\r\n      window._db = db;\r\n    }\r\n\r\n    // repo.beforeClose();\r\n\r\n    return repo;\r\n  }\r\n\r\n  public static async persistLocalDump(dump?: string): Promise<void> {\r\n    await localforage.setItem(RepositoryUtil.DB_NAME, dump || '');\r\n  }\r\n\r\n  public static async exportLocalDump(): Promise<string | null> {\r\n    return await localforage.getItem<string>(RepositoryUtil.DB_NAME);\r\n  }\r\n\r\n  public static generateDumpFromExport(exp: Uint8Array) {\r\n    return Buffer.from(exp).toString(BUFFER_TYPE);\r\n  }\r\n}","import BigNumber from \"bignumber.js\";\r\nimport moment from \"moment\";\r\nimport { RepositoryUtil } from \"../utils/repository\";\r\nimport { IDatabase } from \"./database-connector\";\r\n\r\nexport enum MapperTypes {\r\n  DATE,\r\n  DATE_TIME,\r\n  NUMBER,\r\n  BOOLEAN,\r\n  IGNORE,\r\n}\r\n\r\nexport enum TableNames {\r\n  ACOES = \"acoes\",\r\n  PARAMETROS = \"parametros\",\r\n}\r\n\r\nexport interface DefaultFields {\r\n  id: number\r\n  createdDate: Date\r\n  updatedDate?: Date\r\n}\r\n\r\nconst RUNNED_MIGRATION_CODE = 'runned';\r\n\r\nexport class DefaultRepository {\r\n  protected readonly DEFAULT_MAPPING = { createdDate: MapperTypes.DATE_TIME, updatedDate: MapperTypes.DATE_TIME, monthYear: MapperTypes.IGNORE };\r\n  public constructor(protected db: IDatabase) { }\r\n\r\n  public async saveAll(tableName: TableNames, items: DefaultFields[]) {\r\n    let allParams = {};\r\n    let fullCommand = '';\r\n\r\n    items.forEach((x, i) => {\r\n      let execution = {} as any;\r\n\r\n      if (x.id == null)\r\n        execution = this.createInsertCommand(tableName, x, `${i}`);\r\n      else\r\n        execution = this.createUpdateCommand(tableName, x, `${i}`);\r\n\r\n      const { command, params } = execution;\r\n\r\n      fullCommand = `${fullCommand};${command}`\r\n      allParams = { ...allParams, ...params }\r\n    })\r\n\r\n    console.debug('saveAll', fullCommand, allParams)\r\n\r\n    this.db.exec(fullCommand, allParams);\r\n\r\n    await this.persistDb();\r\n  }\r\n\r\n  public async save(tableName: TableNames, data: any) {\r\n    let result = {} as any;\r\n\r\n    if (data?.id != null)\r\n      result = await this.update(tableName, data)\r\n    else\r\n      result = await this.insert(tableName, data);\r\n\r\n    await this.persistDb();\r\n\r\n    return result;\r\n  }\r\n\r\n  public async delete(tableName: TableNames, id: number) {\r\n    let result = {} as any;\r\n\r\n    await this.db.exec(`delete from ${tableName} where id = $id`, { \"$id\": id })\r\n\r\n    await this.persistDb();\r\n\r\n    return result;\r\n  }\r\n\r\n  public async list<T>(tableName: TableNames): Promise<T[]> {\r\n    await Promise.resolve();\r\n\r\n    const result = await this.db.exec(`SELECT * FROM ${tableName} order by createdDate desc`);\r\n\r\n    if (!Array.isArray(result))\r\n      throw new Error(`${tableName} não encontrado (a)`);\r\n\r\n    return this.parseSqlResultToObj(result, this.DEFAULT_MAPPING)[0] || [];\r\n  }\r\n\r\n  public async get<T>(tableName: TableNames, id: string): Promise<T> {\r\n    await Promise.resolve();\r\n\r\n    const result = await this.db.exec(`select * from ${tableName} where id = $id`, { \"$id\": id });\r\n\r\n    if (result.length === 0)\r\n      throw new Error(`${tableName} não encontrado (a)`);\r\n\r\n    return this.parseSqlResultToObj(result, this.DEFAULT_MAPPING)[0][0];\r\n  }\r\n\r\n  protected async insert(tableName: TableNames, data: any) {\r\n    const { command, params, nextData } = this.createInsertCommand(tableName, data);\r\n    const fullCommand = `${command};SELECT LAST_INSERT_ROWID();`\r\n\r\n    const result = await this.db.exec(fullCommand, params);\r\n\r\n    nextData.id = result[0].values[0][0];\r\n\r\n    return nextData;\r\n  }\r\n\r\n  protected createInsertCommand(tableName: TableNames, data: any, paramsPrefix: string = '') {\r\n    const nextData = { ...data, createdDate: new Date() };\r\n    const { keys, params } = this.parseToCommand(nextData, paramsPrefix);\r\n    const command = `INSERT INTO ${tableName} (${keys.join(', ')}) VALUES (${keys.map(k => `$${k}${paramsPrefix}`).join(', ')})`;\r\n\r\n    return { command, params, nextData }\r\n  }\r\n\r\n  protected async update(tableName: TableNames, data: any) {\r\n    const { command, params } = this.createUpdateCommand(tableName, data);\r\n\r\n    await this.db.exec(command, params);\r\n\r\n    return this.get(tableName, data.id);\r\n  }\r\n\r\n  protected createUpdateCommand(tableName: TableNames, data: any, paramsPrefix: string = '') {\r\n    const nextData = { ...data, updatedDate: new Date() };\r\n    const { keys, params } = this.parseToCommand(nextData, paramsPrefix);\r\n    const command = `UPDATE ${tableName} SET ${keys.map(k => `${k}=$${k}${paramsPrefix}`).join(', ')} WHERE id=$id${paramsPrefix}`;\r\n\r\n    return { command, params, nextData }\r\n  }\r\n\r\n  protected parseSqlResultToObj(result: initSqlJs.QueryExecResult[], mapper?: { [key: string]: MapperTypes }) {\r\n    return result.map(res => res.values.map(values => res.columns.reduce((p, n, i) => {\r\n      const value = values[i];\r\n      let original = true;\r\n\r\n      if (n !== 'id' && value != null) {\r\n        if (mapper != null) {\r\n          if (mapper[n] === MapperTypes.DATE) {\r\n            p[n] = moment(value as any, 'YYYY-MM-DD').toDate(); //2022-11-03 00:00:00\r\n            original = false;\r\n          } else if (mapper[n] === MapperTypes.DATE_TIME) {\r\n            p[n] = moment(value as any, 'YYYY-MM-DD hh:mm:ss').toDate(); //2022-11-03 00:00:00\r\n            original = false;\r\n          } else if (mapper[n] === MapperTypes.NUMBER) {\r\n            p[n] = value;\r\n            original = false;\r\n          } else if (mapper[n] === MapperTypes.BOOLEAN) {\r\n            p[n] = !!value;\r\n            original = false;\r\n          } else if (mapper[n] === MapperTypes.IGNORE) {\r\n            original = false;\r\n          }\r\n        }\r\n\r\n        if (original && typeof (value) === 'number') {\r\n          p[n] = BigNumber(value);\r\n          original = false;\r\n        }\r\n      }\r\n\r\n      if (original)\r\n        p[n] = value;\r\n\r\n      return p;\r\n    }, {} as any)));\r\n  }\r\n\r\n  protected parseToCommand(nextData: any, paramsPrefix: string = '') {\r\n    const keys = Object.keys(nextData).filter(k => nextData[k] !== undefined);\r\n    const params = keys.reduce((p, n) => {\r\n      let value = nextData[n] ?? null;\r\n\r\n      if (value instanceof Date) {\r\n        value = moment(value).format();\r\n      }\r\n\r\n      if (value?._isBigNumber) {\r\n        value = value.toNumber();\r\n      }\r\n\r\n      p[`$${n}${paramsPrefix}`] = value;\r\n\r\n      return p;\r\n    }, {} as any);\r\n\r\n    return { keys, params };\r\n  }\r\n\r\n  protected async runMigrations() {\r\n    await Promise.resolve();\r\n\r\n    await this.db.exec(`CREATE TABLE IF NOT EXISTS \"migrations\" (\"id\" INTEGER NOT NULL,\"name\" TEXT NULL DEFAULT NULL,\"executedDate\" DATETIME NULL,PRIMARY KEY (\"id\"));`);\r\n\r\n    const result = await this.db.exec('select * from \"migrations\"');\r\n    const migrations = (this.parseSqlResultToObj(result)[0] || []).reduce((p, n) => { p[n.name] = n; return p; }, {} as any);\r\n\r\n    if (migrations['parametros'] == null) {\r\n      await this.db.exec(`CREATE TABLE IF NOT EXISTS \"parametros\" (\"id\" INTEGER NOT NULL,\"chave\" TEXT NOT NULL,\"valor\" TEXT NULL, \"createdDate\" DATETIME NOT NULL, \"updatedDate\" DATETIME NULL DEFAULT NULL,PRIMARY KEY (\"id\"));`);\r\n      migrations['parametros'] = RUNNED_MIGRATION_CODE;\r\n    }\r\n\r\n    if (migrations['acoes'] == null) {\r\n      await this.db.exec(`CREATE TABLE IF NOT EXISTS \"acoes\" (\"id\" INTEGER NOT NULL,\"nome\" TEXT NOT NULL,\"logo\" TEXT NULL,\"codigo\" TEXT NULL, \"tipo\" INTEGER NULL, \"active\" INTEGER NULL, \"valorDeMercado\" REAL NULL, \"setor\" TEXT NULL, \"createdDate\" DATETIME NOT NULL, \"updatedDate\" DATETIME NULL DEFAULT NULL,PRIMARY KEY (\"id\"));`);\r\n      migrations['acoes'] = RUNNED_MIGRATION_CODE;\r\n    }\r\n\r\n    if (migrations['desativar_acoes'] == null) {\r\n      await this.db.exec(`UPDATE acoes SET \"active\" = 0 WHERE 1 = 1;`);\r\n      migrations['desativar_acoes'] = RUNNED_MIGRATION_CODE;\r\n    }\r\n\r\n    // TODO: Add parametros iniciais em branco\r\n\r\n    const runnedMigrations = Object.keys(migrations).filter(x => migrations[x] === RUNNED_MIGRATION_CODE).reduce((p, n) => { p.push({ name: n, executedDate: new Date() }); return p; }, [] as any)\r\n\r\n    let allParams = {};\r\n    let fullCommand = '';\r\n\r\n    if (runnedMigrations.length > 0) {\r\n      runnedMigrations.forEach((x, i) => {\r\n        const { keys, params } = this.parseToCommand(x, `${i}`);\r\n        const command = `INSERT INTO \"migrations\" (${keys.join(', ')}) VALUES (${keys.map(k => `$${k}${i}`).join(', ')})`;\r\n\r\n        fullCommand = `${fullCommand};${command}`\r\n        allParams = { ...allParams, ...params }\r\n      });\r\n\r\n      await this.db.exec(fullCommand, allParams);\r\n    }\r\n\r\n    await this.persistDb();\r\n  }\r\n\r\n  public async exportOriginalDump() {\r\n    return await this.db.export();\r\n  }\r\n\r\n  public async persistDb() {\r\n    const dump = await this.exportDump();\r\n\r\n    await RepositoryUtil.persistLocalDump(dump)\r\n    console.debug(\"persistDb ok\");\r\n  }\r\n\r\n  private async exportDump() {\r\n    await Promise.resolve();\r\n    const exp = await this.db.export();\r\n\r\n    return await RepositoryUtil.generateDumpFromExport(exp)\r\n  }\r\n\r\n  private beforeClose() {\r\n    const beforeUnload = (e: any) => {\r\n      const message = \"Ter certeza que deseja sair?\";\r\n      const event = e || window.event;\r\n\r\n      // For IE and Firefox\r\n      if (event) {\r\n        event.returnValue = message;\r\n      }\r\n\r\n      this.persistDb();\r\n\r\n      // For Safari\r\n      return message;\r\n    };\r\n\r\n    window.addEventListener(\"beforeunload\", beforeUnload);\r\n  }\r\n}","import { DefaultFields, DefaultRepository, TableNames } from \"./default\";\r\n\r\nexport interface Parametro extends DefaultFields {\r\n  chave: string\r\n  valor?: string\r\n}\r\n\r\nconst BRAPI_KEY = 'BRAPI_API_KEY';\r\n\r\nexport class ParametrosRepository extends DefaultRepository {\r\n  private _paramsDict?: { [key: string]: Parametro };\r\n\r\n  public async getDict(): Promise<{ [key: string]: Parametro }> {\r\n    if (this._paramsDict == null) {\r\n      this._paramsDict = await this.loadParamsOrDefault();\r\n    }\r\n\r\n    return this._paramsDict;\r\n  }\r\n\r\n  private async loadParamsOrDefault() {\r\n    const params = (await this.list<Parametro>(TableNames.PARAMETROS)).reduce((p, n) => { p[n.chave] = n; return p; }, {});\r\n    const nextParams = params;\r\n\r\n    nextParams[BRAPI_KEY] = params[BRAPI_KEY] || { chave: BRAPI_KEY, valor: '' };\r\n\r\n    const newParams = Object.keys(nextParams).map(x => nextParams[x]).filter(x => x.id == null);\r\n\r\n    await Promise.all(newParams.map(x => this.save(TableNames.PARAMETROS, x)));\r\n\r\n    return nextParams;\r\n  }\r\n\r\n  public async getByKey(chave: string): Promise<Parametro> {\r\n    return (await this.getDict())[chave];\r\n  }\r\n\r\n  public async getValorByKey(chave: string): Promise<string | undefined> {\r\n    return (await this.getDict())[chave]?.valor;\r\n  }\r\n\r\n  public async set(chave: string, valor?: string) {\r\n    const paramsDict = await this.getDict();\r\n    let param = paramsDict[chave];\r\n\r\n    if (param == null)\r\n      param = {} as any;\r\n\r\n    const result = await this.save(TableNames.PARAMETROS, { ...param, chave, valor });\r\n\r\n    delete this._paramsDict;\r\n\r\n    return result;\r\n  }\r\n}","import { GestaoMessage, WorkersActions } from \"./common\";\r\nimport { WorkerDatabaseConnector } from \"./db-connector\";\r\nimport { ParametrosRepository } from \"../repositories/parametros\";\r\nimport moment from \"moment\";\r\nimport { HistoricoAcoesRepository } from \"../repositories/historico-acoes\";\r\n\r\n/* eslint-disable no-restricted-globals */\r\nconsole.debug('yahoo-worker start');\r\n\r\nconst YAHOO_LAST_UPDATE_KEY = 'YAHOO_LAST_UPDATE';\r\nconst dbWorker = new WorkerDatabaseConnector(`yahoo`);\r\nconst repository = new HistoricoAcoesRepository(dbWorker);\r\nconst paramsRepository = new ParametrosRepository(dbWorker);\r\n\r\nself.onmessage = (event: MessageEvent<GestaoMessage>) => {\r\n  console.debug('yahoo.onmessage', event);\r\n\r\n  switch (event.data.action) {\r\n    case WorkersActions.LOAD_ALL: {\r\n      loadAll(event.data);\r\n    }\r\n  }\r\n};\r\n\r\nasync function loadAll(data: GestaoMessage) {\r\n  const lastUpdateParam = await paramsRepository.getByKey(YAHOO_LAST_UPDATE_KEY)\r\n  const lastUpdate = moment(lastUpdateParam?.valor);\r\n  const passou14Dias = moment(new Date()).add(-14, \"days\").isSameOrAfter(lastUpdate);\r\n\r\n  if (true) {\r\n    console.debug('calling yahoo');\r\n\r\n    const rawResponse = await fetch('https://query1.finance.yahoo.com/v7/finance/download/PETR3.SA?period1=-2208988800&period2=1720569600&interval=1d&events=history');\r\n\r\n    const response = await rawResponse.text();\r\n\r\n    console.log(response);\r\n\r\n    console.debug('end calling yahoo');\r\n  } else console.debug('not needed to call yahoo;')\r\n\r\n\r\n  self.postMessage({ id: data.id, response: { success: true } });\r\n}\r\n\r\n\r\nconsole.debug('yahoo-worker end');\r\n\r\nexport { };","import { DefaultFields, DefaultRepository } from \"./default\";\r\n\r\n\r\nexport interface HistoricoAcoes extends DefaultFields {\r\n}\r\n\r\nexport class HistoricoAcoesRepository extends DefaultRepository {\r\n  public readonly HISTORICO_ACOES_MAPPING = { ...this.DEFAULT_MAPPING }\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = () => {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [846,924], () => (__webpack_require__(409)))\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + {\"151\":\"d3f9119b\",\"846\":\"ffe85a79\",\"924\":\"8fb96675\"}[chunkId] + \".chunk.js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"/gestao-trade/\";","__webpack_require__.b = self.location + \"/../../../\";\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t409: 1\n};\n\n// importScripts chunk loading\nvar installChunk = (data) => {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkgestao_trade\"] = self[\"webpackChunkgestao_trade\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = () => {\n\treturn Promise.all([\n\t\t__webpack_require__.e(846),\n\t\t__webpack_require__.e(924)\n\t]).then(next);\n};","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["WorkersActions","UNIQUE_KEY","crypto","randomUUID","DB_CHANNEL_SEND","concat","DB_CHANNEL_RECEIVE","DatabaseConnector","constructor","currentId","worker","onMessages","this","Worker","URL","onerror","e","console","log","onmessage","event","id","data","action","error","Error","exec","sql","params","nextId","Promise","resolve","reject","debug","results","postMessage","export","buffer","open","BUFFER_TYPE","RepositoryUtil","create","localDump","exportLocalDump","Buffer","from","db","repo","DefaultRepository","runMigrations","persistLocalDump","dump","localforage","DB_NAME","generateDumpFromExport","exp","toString","MapperTypes","TableNames","RUNNED_MIGRATION_CODE","DEFAULT_MAPPING","createdDate","DATE_TIME","updatedDate","monthYear","IGNORE","saveAll","tableName","items","allParams","fullCommand","forEach","x","i","execution","createInsertCommand","createUpdateCommand","command","persistDb","save","result","update","insert","delete","list","Array","isArray","parseSqlResultToObj","get","length","nextData","values","paramsPrefix","arguments","undefined","Date","keys","parseToCommand","join","map","k","mapper","res","columns","reduce","p","n","value","original","DATE","moment","toDate","NUMBER","BOOLEAN","BigNumber","Object","filter","_nextData$n","_value","format","_isBigNumber","toNumber","migrations","name","runnedMigrations","push","executedDate","exportOriginalDump","exportDump","beforeClose","window","addEventListener","message","returnValue","BRAPI_KEY","YAHOO_LAST_UPDATE_KEY","dbWorker","workerName","broadcastSend","BroadcastChannel","broadcastReceive","broadcastConnect","onExecMessages","onmessageerror","swName","sendChannel","receiveChannel","setOnMessage","postReceive","paramsRepository","HISTORICO_ACOES_MAPPING","_paramsDict","getDict","loadParamsOrDefault","PARAMETROS","chave","nextParams","valor","newParams","all","getByKey","getValorByKey","_await$this$getDict$c","set","param","self","LOAD_ALL","async","lastUpdateParam","lastUpdate","add","isSameOrAfter","rawResponse","fetch","response","text","success","loadAll","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","loaded","__webpack_modules__","call","m","__webpack_exports__","O","deferred","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","key","splice","r","getter","__esModule","d","a","definition","o","defineProperty","enumerable","f","chunkId","promises","u","miniCssF","g","globalThis","Function","obj","prop","prototype","hasOwnProperty","nmd","paths","children","b","location","installedChunks","importScripts","chunkLoadingGlobal","parentChunkLoadingFunction","bind","moreModules","runtime","pop","next","then"],"sourceRoot":""}